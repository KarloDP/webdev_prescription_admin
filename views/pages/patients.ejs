<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Patients</title>
  <link rel="stylesheet" href="/css/patients.css">
</head>
<body>
  <h1>Patients</h1>

  <!-- Search/Filter Section -->
  <section class="search-section">
    <h2>Search / Filter</h2>
    <form method="GET" action="/patients">
      <input type="text" name="name" placeholder="Name" value="<%= name || '' %>">
      <input type="text" name="email" placeholder="Email" value="<%= email || '' %>">
      <input type="number" name="doctorID" placeholder="Doctor ID" value="<%= doctorID || '' %>">

      <select name="gender" id="gender">
        <option value="">-- Gender --</option>
        <option value="male" <%= gender === 'male' ? 'selected' : '' %>>Male</option>
        <option value="female" <%= gender === 'female' ? 'selected' : '' %>>Female</option>
        <option value="other" <%= gender === 'other' ? 'selected' : '' %>>Other</option>
      </select>

      <button type="submit">Search</button>
    </form>
  </section>
  <br>

  <!-- Results Table -->
  <section class="results-section">
    <table>
      <thead>
        <tr>
          <th>ID</th><th>Name</th><th>Email</th><th>Date of Birth</th>
          <th>Gender</th><th>Phone</th><th>Address</th><th>Doctor</th><th>Action</th>
        </tr>
      </thead>
      <tbody>
        <% if (patients && patients.length > 0) { %>
          <% patients.forEach(patient => { %>
            <tr>
              <td data-label="ID"><%= patient.patientID %></td>
              <td data-label="Name"><%= patient.firstName %> <%= patient.lastName %></td>
              <td data-label="Email"><%= patient.email %></td>
              <td data-label="Date of Birth"><%= patient.birthDate %></td>
              <td data-label="Gender"><%= patient.gender %></td>
              <td data-label="Phone"><%= patient.contactNumber %></td>
              <td data-label="Address"><%= patient.address %></td>
              <td data-label="Doctor"><%= patient.doctorID %></td>
              <td data-label="Action">
                <form method="POST" action="/patients/delete" style="display:inline;">
                  <input type="hidden" name="patientID" value="<%= patient.patientID %>">
                  <button type="submit">Delete</button>
                </form>
              </td>
            </tr>
          <% }) %>
        <% } else { %>
          <tr><td colspan="9">No patients found.</td></tr>
        <% } %>
      </tbody>
    </table>
  </section>

  <!-- Add Patient Form -->
  <h2>Add New Patient</h2>
  <form method="POST" action="/patients/add">
    <input type="text" name="firstName" placeholder="First Name" required>
    <input type="text" name="lastName" placeholder="Last Name" required>
    <input type="text" name="password" placeholder="Password" required>
    <input type="date" name="birthDate" required>
    <input type="email" name="email" placeholder="Email" required>

    <select name="gender" id="gender" required>
      <option value="">-- Select Gender --</option>
      <option value="male">Male</option>
      <option value="female">Female</option>
      <option value="other">Other</option>
    </select>

    <input type="text" name="contactNumber" placeholder="Contact Number" required>
    <input type="text" name="address" placeholder="Address" required>
    <input type="number" name="doctorID" placeholder="Doctor ID" required>
    <button type="submit">Add Patient</button>
  </form>

  <a href="/dashboard" class="back-btn">Back to Dashboard</a>
</body>
</html>
